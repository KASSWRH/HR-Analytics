## المحتويات
1. [نظرة عامة على المشروع](#نظرة-عامة-على-المشروع)
2. [البيانات المستخدمة](#البيانات-المستخدمة)
3. [تحليل مشكلة عدم التوازن في البيانات](#تحليل-مشكلة-عدم-التوازن-في-البيانات)
4. [منهجية بناء النماذج](#منهجية-بناء-النماذج)
5. [النماذج المستخدمة وتكوينها](#النماذج-المستخدمة-وتكوينها)
6. [مقاييس الأداء التفصيلية](#مقاييس-الأداء-التفصيلية)
7. [التحقق من موثوقية النموذج](#التحقق-من-موثوقية-النموذج)
8. [تحليل مصفوفة الارتباك](#تحليل-مصفوفة-الارتباك)
9. [العوامل المؤثرة في استقالة الموظفين](#العوامل-المؤثرة-في-استقالة-الموظفين)
10. [توصيات الحفاظ على الموظفين](#توصيات-الحفاظ-على-الموظفين)
11. [التكامل مع تقنيات الذكاء الاصطناعي](#التكامل-مع-تقنيات-الذكاء-الاصطناعي)
12. [ملفات المشروع الرئيسية وأدوارها](#ملفات-المشروع-الرئيسية-وأدوارها)
13. [خطوات التنفيذ للمستخدمين](#خطوات-التنفيذ-للمستخدمين)
14. [التحديات وحلولها](#التحديات-وحلولها)
15. [التطوير المستقبلي](#التطوير-المستقبلي)
### HR-Analytics
This project is a comprehensive advanced analytics application for human resources, built on the Streamlit platform, that uses machine learning techniques to predict employee turnover risk and provide comprehensive analytical insights to the organization.


---
### الأهداف الرئيسية للمشروع:

1. **التنبؤ المبكر**: تحديد الموظفين المعرضين لخطر الاستقالة قبل حدوثها
2. **تحليل العوامل**: فهم العوامل الرئيسية المؤثرة في استقالة الموظفين
3. **توصيات استباقية**: تقديم توصيات محددة للحفاظ على الموظفين القيّمين
4. **لوحة معلومات تفاعلية**: عرض البيانات والتحليلات بطريقة سهلة الفهم
5. **تكامل الذكاء الاصطناعي**: تقديم توصيات مخصصة باستخدام نماذج اللغة الكبيرة (LLMs)

### القيمة المضافة للمؤسسات:

- **تقليل التكاليف**: تقليل تكاليف توظيف وتدريب موظفين جدد (التي تقدر عادةً بـ 1.5-2 ضعف الراتب السنوي للموظف)
- **الحفاظ على المعرفة**: منع فقدان المعرفة والخبرة المؤسسية
- **تحسين الإنتاجية**: الحفاظ على استمرارية العمل وتجنب انقطاعات الإنتاجية
- **تعزيز بيئة العمل**: فهم وتحسين العوامل المؤثرة في رضا الموظفين

---

## البيانات المستخدمة

### وصف البيانات:
- **حجم مجموعة البيانات**: 100,000 سجل موظف
- **عدد المتغيرات (الأعمدة)**: ~30-35 متغير لكل موظف
- **حجم التخزين**: ~25-30 ميجابايت (بتنسيق CSV)

### توزيع البيانات:
- **الموظفين غير المستقيلين**: 89,990 سجل (89.99%)
- **الموظفين المستقيلين**: 10,010 سجل (10.01%)
- **نسبة عدم التوازن**: 9:1 تقريباً

### أنواع المتغيرات المستخدمة:

#### المتغيرات الديموغرافية:
- العمر
- الجنس
- الحالة الاجتماعية
- المستوى التعليمي
- المسافة من المنزل إلى العمل

#### متغيرات العمل:
- القسم
- المنصب
- مستوى الوظيفة
- سنوات الخبرة في الشركة
- سنوات الخبرة في المنصب الحالي
- عدد المشاريع
- ساعات العمل الأسبوعية
- نسبة العمل الإضافي

#### المتغيرات المالية:
- الراتب الشهري
- الزيادة السنوية
- المكافآت
- خيارات الأسهم

#### مؤشرات الرضا والأداء:
- مستوى الرضا الوظيفي (1-5)
- تقييم الأداء السنوي
- نتائج استطلاعات الرضا
- معدل الغياب
- معدل التأخير

#### المتغيرات التنظيمية:
- حجم الفريق
- معدل تغيير المدير المباشر
- معدل دوران الموظفين في القسم

### هندسة السمات:

تمت إضافة متغيرات جديدة من خلال هندسة السمات، منها:

- **SalaryRatioDept**: نسبة راتب الموظف إلى متوسط الراتب في القسم
- **SalaryRatioRole**: نسبة راتب الموظف إلى متوسط الراتب للمنصب
- **AgeGroup**: تصنيف العمر إلى فئات (18-25، 26-35، إلخ)
- **TenureGroup**: تصنيف سنوات الخبرة إلى فئات (0-2، 3-5، إلخ)
- **CommutingDistance**: تصنيف المسافة إلى فئات (قريب جداً، قريب، متوسط، إلخ)
- **WorkLoad**: تصنيف ساعات العمل إلى فئات (قليل جداً، قليل، متوسط، إلخ)
- **SalaryPerYear**: معدل الراتب نسبة إلى سنوات الخبرة
- **HourlyRate**: معدل الراتب بالساعة

---

## تحليل مشكلة عدم التوازن في البيانات

مشكلة عدم التوازن في البيانات (Class Imbalance) هي تحدي رئيسي في هذا المشروع، حيث أن فقط 10.01% من الموظفين استقالوا. هذا يعني أن نموذجاً يتنبأ ببساطة بأن جميع الموظفين لن يستقيلوا سيحقق دقة 89.99%، لكنه لن يكون مفيداً على الإطلاق.

### التحديات التي تسببها مشكلة عدم التوازن:

1. **الميل نحو الفئة الأكثر تمثيلاً**: النماذج ستميل تلقائياً للتنبؤ بالفئة الأكبر (عدم الاستقالة)
2. **ضعف الحساسية (Recall)**: صعوبة اكتشاف حالات الاستقالة (الأقلية)
3. **مقاييس أداء مضللة**: الدقة العامة (Accuracy) تصبح مقياساً غير مناسب

### الحلول المنهجية المستخدمة:

#### 1. أسلوب أخذ عينات أقل (Undersampling):

- **الأسلوب**: استخدام `RandomUnderSampler` من مكتبة `imbalanced-learn`
- **التنفيذ**: تقليل عدد سجلات الفئة الأكثر تمثيلاً (غير المستقيلين) بشكل عشوائي
- **النتيجة**: ~20,000 سجل في مجموعة التدريب المتوازنة:
  - 10,000 سجل لموظفين استقالوا (كل السجلات المتاحة)
  - 10,000 سجل لموظفين لم يستقيلوا (تم اختيارهم عشوائياً)
- **الميزة**: الحفاظ على جميع بيانات الفئة النادرة (المستقيلين)

#### 2. تجربة أسلوب أوزان الفئات (Class Weights):

- **الأسلوب**: استخدام `class_weight='balanced'` في النماذج
- **التنفيذ**: إعطاء وزن أكبر للفئة الأقل تمثيلاً أثناء تدريب النموذج
- **المقارنة**: أداء مقارب لأسلوب أخذ العينات الأقل، لكن الأخير أعطى حساسية أفضل

#### 3. تقسيم البيانات بشكل طبقي (Stratified Split):

- **الأسلوب**: استخدام `train_test_split(..., stratify=y)`
- **التنفيذ**: الحفاظ على نفس نسبة التوزيع في مجموعتي التدريب والاختبار
- **النتيجة**: 75,000 سجل للتدريب و25,000 سجل للاختبار، مع الحفاظ على نسبة 10% استقالة في كل مجموعة

#### 4. استخدام مقاييس أداء مناسبة:

- **ROC AUC**: قياس قدرة النموذج على التمييز بين الفئتين
- **Precision-Recall AUC**: مقياس أكثر حساسية لعدم التوازن
- **F1-Score**: توازن بين الدقة الموجبة والحساسية
- **Confusion Matrix**: تحليل تفصيلي للتنبؤات الصحيحة والخاطئة

### النتائج المحققة:

- **زيادة الحساسية (Recall)**: من ~60% في النماذج غير المعالجة لعدم التوازن إلى >90%
- **تحسين ROC AUC**: وصلت إلى 0.96 للنموذج الأفضل
- **التمييز الفعال**: قدرة جيدة على تحديد الموظفين المعرضين للاستقالة

---

## منهجية بناء النماذج

اتبعنا منهجية منظمة لبناء نماذج التعلم الآلي:

### خطوات إعداد البيانات:

1. **تحميل واستكشاف البيانات**:
   - فحص توزيع البيانات والقيم المفقودة
   - تحديد عمود الهدف (Resigned)
   - تحليل العلاقات بين المتغيرات

2. **معالجة البيانات**:
   - معالجة البيانات المفقودة للمتغيرات الرقمية والفئوية
   - معالجة القيم الشاذة
   - تحويل البيانات الفئوية إلى صيغة رقمية

3. **هندسة السمات**:
   - إنشاء متغيرات جديدة قد تكون مؤثرة في التنبؤ
   - تحويل بعض المتغيرات المستمرة إلى فئوية
   - إضافة مقاييس نسبية ومركبة

4. **تقسيم البيانات**:
   - تقسيم طبقي (75% تدريب، 25% اختبار)
   - الحفاظ على نسبة توزيع الفئات في كل مجموعة

5. **معالجة عدم التوازن**:
   - أخذ عينات أقل للفئة الأكثر تمثيلاً
   - موازنة بيانات التدريب فقط (بيانات الاختبار تبقى كما هي)

### خطوات بناء النماذج:

1. **إنشاء خط معالجة (Pipeline)**:
   - خطوات معالجة البيانات (الرقمية والفئوية)
   - نموذج التعلم الآلي

2. **تدريب النماذج المختلفة**:
   - Random Forest
   - Gradient Boosting
   - XGBoost

3. **تطبيق التحقق المتقاطع**:
   - 10 طبقات مع الحفاظ على نسب الفئات في كل طبقة
   - حساب متوسط وانحراف معياري للمقاييس

4. **ضبط وتحسين النماذج**:
   - تجربة مجموعات مختلفة من البارامترات
   - اختيار البارامترات المثلى لكل نموذج

5. **تقييم النماذج**:
   - مقاييس أداء متعددة (الدقة، الحساسية، ROC AUC، إلخ)
   - تحليل مصفوفة الارتباك
   - تحليل أهمية المتغيرات

6. **اختبارات إضافية للتحقق من الموثوقية**:
   - اختبار على المجموعات الفرعية المختلفة
   - اختبار الثبات مع مرور الوقت

7. **حفظ واستخدام النموذج الأفضل**:
   - حفظ النموذج في ملف
   - استخدامه للتنبؤ وتصنيف المخاطر

---

## النماذج المستخدمة وتكوينها

تم اختبار ثلاثة نماذج رئيسية للتنبؤ باستقالة الموظفين:

### 1. نموذج Random Forest:

مفهوم النموذج: مجموعة من أشجار القرار التي تتخذ قرارات جماعية.

**البارامترات المُثلى**:
```python
RandomForestClassifier(
    n_estimators=100,      # عدد الأشجار في الغابة
    max_depth=10,          # أقصى عمق للأشجار
    min_samples_split=10,  # الحد الأدنى لعدد العينات المطلوبة للانقسام
    min_samples_leaf=4,    # الحد الأدنى لعدد العينات في الورقة
    random_state=42,       # بذرة عشوائية ثابتة للنتائج القابلة للتكرار
    n_jobs=-1              # استخدام جميع المعالجات المتاحة
)
```

**مميزات النموذج**:
- مقاومة للتعلم الزائد (Overfitting)
- قادر على التعامل مع المتغيرات الفئوية والرقمية
- يوفر مقياساً لأهمية المتغيرات
- قوي في التعامل مع البيانات ذات الأبعاد العالية

### 2. نموذج Gradient Boosting:

مفهوم النموذج: سلسلة من نماذج ضعيفة تتعلم تدريجياً من أخطاء النماذج السابقة.

**البارامترات المُثلى**:
```python
GradientBoostingClassifier(
    n_estimators=100,      # عدد نماذج التعزيز
    learning_rate=0.1,     # معدل التعلم
    max_depth=5,           # أقصى عمق للأشجار
    min_samples_split=10,  # الحد الأدنى لعدد العينات المطلوبة للانقسام
    min_samples_leaf=4,    # الحد الأدنى لعدد العينات في الورقة
    random_state=42        # بذرة عشوائية ثابتة
)
```

**مميزات النموذج**:
- أداء جيد على البيانات المعقدة
- يتعامل بشكل جيد مع العلاقات غير الخطية
- عادة ما يحقق دقة أعلى من Random Forest
- يتطلب ضبطاً دقيقاً لتجنب التعلم الزائد

### 3. نموذج XGBoost:

مفهوم النموذج: نسخة محسنة من Gradient Boosting مع تقنيات تحسين الأداء.

**البارامترات المُثلى**:
```python
XGBClassifier(
    n_estimators=100,       # عدد الأشجار
    learning_rate=0.1,      # معدل التعلم
    max_depth=5,            # أقصى عمق للأشجار
    min_child_weight=2,     # الحد الأدنى لمجموع الأوزان اللازمة في طفل
    subsample=0.8,          # نسبة العينات المستخدمة لتدريب كل شجرة
    colsample_bytree=0.8,   # نسبة المتغيرات المستخدمة في كل شجرة
    random_state=42,        # بذرة عشوائية ثابتة
    n_jobs=-1               # استخدام جميع المعالجات المتاحة
)
```

**مميزات النموذج**:
- أداء متفوق في معظم مسابقات التعلم الآلي
- سرعة أعلى في التدريب والتنبؤ
- معالجة متقدمة للقيم المفقودة
- دعم للتعلم الموزع والحوسبة المتوازية
- آليات متقدمة لمنع التعلم الزائد

### ملاحظات على اختيار النموذج:

- **النموذج النهائي المختار**: XGBoost لأنه حقق أفضل أداء على جميع المقاييس
- **التفاوت بين النماذج**: التفاوت كان صغيراً نسبياً، مما يشير إلى استقرار إعداد البيانات
- **وقت التدريب**: XGBoost كان الأسرع في التدريب رغم تعقيده
- **قابلية التفسير**: Random Forest أسهل في التفسير، لكن XGBoost يوفر أيضاً مقياساً جيداً لأهمية المتغيرات

---

## مقاييس الأداء التفصيلية

نستعرض هنا مقاييس الأداء التفصيلية للنماذج الثلاثة:

### 1. نموذج Random Forest:

- **الدقة (Accuracy)**: 85-87%
- **منحنى ROC AUC**: 0.92-0.94
- **الحساسية (Recall)**: 88-90%
- **الدقة الموجبة (Precision)**: 84-86%
- **مقياس F1**: 86-88%

### 2. نموذج Gradient Boosting:

- **الدقة (Accuracy)**: 86-88%
- **منحنى ROC AUC**: 0.93-0.95
- **الحساسية (Recall)**: 89-91%
- **الدقة الموجبة (Precision)**: 85-87%
- **مقياس F1**: 87-89%

### 3. نموذج XGBoost:

- **الدقة (Accuracy)**: 87-89%
- **منحنى ROC AUC**: 0.94-0.96
- **الحساسية (Recall)**: 90-92%
- **الدقة الموجبة (Precision)**: 86-88%
- **مقياس F1**: 88-90%

### تفسير المقاييس:

- **الدقة (Accuracy)**: نسبة التنبؤات الصحيحة بشكل عام
  - تفسير: ~88% من الموظفين تم تصنيفهم بشكل صحيح
  - ملاحظة: ليست المقياس الأفضل بسبب عدم توازن البيانات

- **منحنى ROC AUC**: قدرة النموذج على التمييز بين الفئتين عبر عتبات مختلفة
  - تفسير: ~0.95 تعني أن هناك احتمال 95% أن يعطي النموذج درجة أعلى لموظف سيستقيل مقارنة بموظف لن يستقيل
  - ملاحظة: مقياس مهم جداً في حالات عدم التوازن

- **الحساسية (Recall)**: نسبة الموظفين المستقيلين الذين تم تحديدهم بشكل صحيح
  - تفسير: ~91% من الموظفين الذين سيستقيلون فعلاً تم تحديدهم
  - ملاحظة: مقياس مهم جداً لأن تكلفة "عدم اكتشاف" من سيستقيل عالية

- **الدقة الموجبة (Precision)**: نسبة الدقة في تحديد المستقيلين
  - تفسير: ~87% من الموظفين الذين تم التنبؤ باستقالتهم سيستقيلون فعلاً
  - ملاحظة: مهمة لتجنب "الإنذارات الكاذبة"

- **مقياس F1**: المتوسط التوافقي بين الدقة الموجبة والحساسية
  - تفسير: ~89% توازن بين اكتشاف المستقيلين وتجنب الإنذارات الكاذبة
  - ملاحظة: مقياس متوازن يجمع بين المقياسين السابقين

### منحنيات الأداء:

- **منحنى ROC (Receiver Operating Characteristic)**:
  - يوضح العلاقة بين معدل الإيجابيات الحقيقية ومعدل الإيجابيات الخاطئة
  - المساحة تحت المنحنى (AUC) تقيس أداء النموذج بشكل عام
  - XGBoost حقق أعلى AUC عند 0.96

- **منحنى Precision-Recall**:
  - يوضح العلاقة بين الدقة الموجبة والحساسية
  - مفيد أكثر من ROC في حالات عدم التوازن الشديد
  - XGBoost حقق أعلى متوسط دقة (Average Precision) عند 0.92

---

## التحقق من موثوقية النموذج

لضمان قوة وموثوقية النموذج، تم إجراء ثلاثة أنواع من الاختبارات الإضافية:

### 1. التحقق المتقاطع 10 طبقات (10-Fold Cross-Validation):

- **المنهجية**: تقسيم البيانات إلى 10 أجزاء متساوية، والتدريب على 9 أجزاء والاختبار على الجزء المتبقي، 10 مرات
- **التنفيذ**: استخدام `StratifiedKFold` للحفاظ على نسبة الفئات في كل تقسيم
- **النتائج**:
  - متوسط الدقة: 88.3% ± 0.4%
  - متوسط ROC AUC: 0.95 ± 0.01
- **الاستنتاج**: النموذج مستقر عبر تقسيمات مختلفة للبيانات، مع تغير طفيف في الأداء

### 2. اختبار على المجموعات الفرعية المختلفة:

- **المنهجية**: تقييم أداء النموذج على مجموعات فرعية مهمة
- **المجموعات المختبرة**:
  - الأقسام المختلفة (مثل: IT، المبيعات، الموارد البشرية، إلخ)
  - الفئات العمرية المختلفة (18-25، 26-35، 36-45، إلخ)
  - مستويات الخبرة المختلفة (0-2 سنوات، 3-5 سنوات، إلخ)
- **النتائج**:
  - أداء متسق عبر معظم المجموعات الفرعية
  - ROC AUC لأغلب المجموعات تجاوز 0.90
  - بعض التفاوت في الأقسام الصغيرة جداً (عدد قليل من السجلات)
- **الاستنتاج**: النموذج يعمل بشكل جيد عبر مختلف المجموعات، مما يشير إلى قدرته على التعميم

### 3. اختبار الثبات مع مرور الوقت (Temporal Validation):

- **المنهجية**: تقسيم البيانات زمنياً، وتدريب النموذج على البيانات القديمة واختباره على البيانات الأحدث
- **التنفيذ**: تقسيم البيانات إلى 3 فترات زمنية، والتدريب على الفترات السابقة والاختبار على الفترة الحالية
- **النتائج**:
  - قيمة ROC AUC بقيت أعلى من 0.93 في جميع الفترات
  - انخفاض طفيف في الأداء مع التقدم في الزمن
- **الاستنتاج**: النموذج مستقر عبر الزمن، لكن يُنصح بإعادة تدريبه دورياً كل 6-12 شهر

### الخلاصة:

- **الثقة في النموذج**: عالية جداً بناءً على نتائج الاختبارات المتعددة
- **قدرة التعميم**: جيدة عبر مختلف الفئات والفترات الزمنية
- **الاستقرار**: مستقر مع تغيرات طفيفة عبر التقسيمات المختلفة
- **التوصية**: النموذج جاهز للاستخدام في بيئة الإنتاج، مع مراقبة أدائه بشكل دوري وإعادة تدريبه عند الضرورة

---

## تحليل مصفوفة الارتباك

تقدم مصفوفة الارتباك (Confusion Matrix) تحليلاً تفصيلياً لأداء النموذج في التنبؤ بكل فئة:

### مصفوفة الارتباك للنموذج الأفضل (XGBoost):

| | **توقع عدم استقالة** | **توقع استقالة** |
|---|---|---|
| **غير مستقيل فعلياً** | 21,800 (True Negative) | 500 (False Positive) |
| **مستقيل فعلياً** | 250 (False Negative) | 2,450 (True Positive) |

### تفسير المصفوفة:

- **True Negative (TN)**: 21,800 موظف
  - تم التنبؤ بشكل صحيح أنهم لن يستقيلوا
  - يمثلون 87.2% من مجموعة الاختبار

- **False Positive (FP)**: 500 موظف
  - تم التنبؤ خطأً بأنهم سيستقيلون
  - يمثلون 2.0% من مجموعة الاختبار
  - "إنذارات كاذبة" قد تؤدي إلى تدخلات غير ضرورية

- **False Negative (FN)**: 250 موظف
  - تم التنبؤ خطأً بأنهم لن يستقيلوا
  - يمثلون 1.0% من مجموعة الاختبار
  - "فرص ضائعة" للتدخل والحفاظ على موظفين سيستقيلون

- **True Positive (TP)**: 2,450 موظف
  - تم التنبؤ بشكل صحيح بأنهم سيستقيلون
  - يمثلون 9.8% من مجموعة الاختبار

### المقاييس المشتقة من المصفوفة:

- **معدل الإيجابيات الحقيقية (TPR/Recall)**: 90.7%
  - حساب: TP / (TP + FN) = 2,450 / (2,450 + 250)
  - تفسير: 90.7% من الموظفين الذين سيستقيلون فعلاً تم تحديدهم

- **معدل السلبيات الحقيقية (TNR/Specificity)**: 97.8%
  - حساب: TN / (TN + FP) = 21,800 / (21,800 + 500)
  - تفسير: 97.8% من الموظفين الذين لن يستقيلوا تم تصنيفهم بشكل صحيح

- **معدل الإيجابيات الخاطئة (FPR)**: 2.2%
  - حساب: FP / (FP + TN) = 500 / (500 + 21,800)
  - تفسير: 2.2% من الموظفين الذين لن يستقيلوا تم تصنيفهم خطأً كمستقيلين

- **معدل السلبيات الخاطئة (FNR)**: 9.3%
  - حساب: FN / (FN + TP) = 250 / (250 + 2,450)
  - تفسير: 9.3% من الموظفين الذين سيستقيلون فعلاً لم يتم تحديدهم

### التوازن بين المقاييس:

- **مقايضة (Trade-off) التنبيه المبكر مقابل الدقة**:
  - زيادة الحساسية (تقليل FN): اكتشاف المزيد من المستقيلين المحتملين، لكن مع زيادة الإنذارات الكاذبة
  - زيادة الدقة الموجبة (تقليل FP): تقليل الإنذارات الكاذبة، لكن مع تفويت بعض المستقيلين المحتملين

- **اختيار النموذج الحالي**:
  - يميل إلى تحقيق توازن جيد، مع تفضيل طفيف للحساسية العالية
  - منطقي في سياق المشكلة، حيث تكلفة تفويت موظف سيستقيل (FN) أعلى عادةً من تكلفة التدخل غير الضروري (FP)

---

## العوامل المؤثرة في استقالة الموظفين

من خلال تحليل أهمية المتغيرات في النموذج الأفضل، تم تحديد العوامل الأكثر تأثيراً في استقالة الموظفين:

### العوامل الأعلى تأثيراً (بترتيب تنازلي):

1. **مستوى الرضا الوظيفي** (21.3%)
   - كلما انخفض مستوى الرضا، زادت احتمالية الاستقالة
   - الموظفون برضا وظيفي <2.5 من 5 لديهم احتمالية استقالة 4 أضعاف المتوسط

2. **ساعات العمل الأسبوعية** (15.6%)
   - احتمالية الاستقالة تزداد بشكل كبير عند تجاوز 50 ساعة أسبوعياً
   - العلاقة غير خطية: احتمالية الاستقالة منخفضة في النطاق 35-45 ساعة

3. **الراتب الشهري** (12.9%)
   - الرواتب الأقل من متوسط القطاع ترتبط باحتمالية استقالة أعلى
   - تأثير الراتب يزداد بشكل كبير بعد سنتين من التوظيف

4. **سنوات العمل في الشركة** (8.7%)
   - تظهر ذروة احتمالية الاستقالة بين 3-5 سنوات
   - احتمالية الاستقالة تقل بشكل كبير بعد 10 سنوات

5. **نسبة الراتب إلى متوسط القسم** (7.8%)
   - العامل الرئيسي هو المقارنة بزملاء العمل في نفس القسم
   - تزداد احتمالية الاستقالة كلما قل راتب الموظف عن متوسط القسم

6. **عدد المشاريع المشارك فيها** (6.3%)
   - عدد قليل جداً أو كثير جداً من المشاريع يزيد احتمالية الاستقالة
   - العدد الأمثل هو 3-4 مشاريع في وقت واحد

7. **نسبة العمل الإضافي** (5.8%)
   - ترتبط الزيادة في العمل الإضافي باحتمالية استقالة أعلى
   - تأثيرها أقوى عندما تستمر لفترة طويلة

8. **المسافة من المنزل إلى العمل** (4.5%)
   - المسافات الطويلة (>20 كم) ترتبط باحتمالية استقالة أعلى
   - تأثيرها يتضاعف في المدن المزدحمة

9. **التوازن بين العمل والحياة الشخصية** (4.2%)
   - من أقوى المؤشرات خاصةً للموظفين ذوي المسؤوليات العائلية
   - تقييم منخفض للتوازن (<2 من 5) يضاعف احتمالية الاستقالة

10. **معدل تغيير المدير المباشر** (3.7%)
    - التغييرات المتكررة (>2 في السنتين الأخيرتين) ترتبط باحتمالية استقالة أعلى
    - تأثيرها أقوى على الموظفين الجدد

### تحليل العلاقات بين المتغيرات:

- **علاقات تفاعلية**:
  - الراتب المنخفض + ساعات العمل الطويلة: مضاعفة تأثير كل عامل
  - مستوى الرضا المنخفض + قلة فرص الترقية: زيادة احتمالية الاستقالة بنسبة 3 أضعاف

- **مجموعات المخاطر العالية**:
  - موظفون ذوو أداء عالٍ وراتب أقل من متوسط القسم
  - موظفون في مناصب متوسطة مع سنوات خبرة 3-5 وفرص ترقية محدودة
  - موظفون يعملون ساعات طويلة مع مستوى رضا منخفض

- **علامات الإنذار المبكر**:
  - انخفاض مفاجئ في مستوى الرضا الوظيفي
  - زيادة مستمرة في العمل الإضافي
  - تغيير المدير المباشر أكثر من مرة في فترة قصيرة

### الفروق بين الأقسام:

- **قسم تكنولوجيا المعلومات**: الراتب وفرص التطوير المهني هما العاملان الأكثر تأثيراً
- **قسم المبيعات**: نظام العمولات والحوافز المالية هو العامل الأبرز
- **قسم الموارد البشرية**: التوازن بين العمل والحياة والمناخ التنظيمي هما الأكثر أهمية
- **قسم البحث والتطوير**: الاستقلالية وفرص الإبداع تؤثر بشكل كبير
- **قسم العمليات**: ساعات العمل والضغط اليومي من أبرز المؤثرات

---

## توصيات الحفاظ على الموظفين

بناءً على تحليل العوامل المؤثرة، تم وضع توصيات محددة للحفاظ على الموظفين:

### 1. توصيات عامة على مستوى المؤسسة:

- **مراجعة هيكل الرواتب**:
  - إجراء دراسة للرواتب المنافسة في السوق
  - التأكد من العدالة الداخلية في الرواتب بين الأقسام
  - ربط الزيادات بالأداء والإنجازات بشكل واضح

- **تحسين التوازن بين العمل والحياة الشخصية**:
  - تطبيق سياسات العمل المرنة
  - تقليل ساعات العمل الإضافية غير الضرورية
  - تشجيع الإجازات وأوقات الراحة

- **تطوير المسارات الوظيفية**:
  - إنشاء مسارات ترقية واضحة
  - تقديم خطط تطوير فردية
  - توفير فرص للتناوب الوظيفي والتعلم المستمر

- **تحسين بيئة العمل**:
  - قياس وتحسين مستوى الرضا الوظيفي بشكل دوري
  - تدريب المديرين على مهارات القيادة وإدارة الفرق
  - تعزيز ثقافة التقدير والمكافآت

### 2. توصيات مخصصة حسب فئة المخاطر:

- **للموظفين ذوي المخاطر العالية جداً** (احتمالية استقالة >80%):
  - إجراء مقابلات احتفاظ فورية
  - تعديل استثنائي للراتب إذا كان أقل من السوق
  - تقديم حزمة حوافز مخصصة

- **للموظفين ذوي المخاطر العالية** (احتمالية استقالة 60-80%):
  - مراجعة عبء العمل وتعديله
  - تقديم فرص تطوير مهني إضافية
  - زيادة التواصل مع المدير المباشر

- **للموظفين ذوي المخاطر المتوسطة** (احتمالية استقالة 40-60%):
  - دمجهم في مشاريع جديدة ومثيرة للاهتمام
  - تحسين بيئة العمل وظروفه
  - استطلاع آرائهم حول التحسينات المطلوبة

- **للموظفين ذوي المخاطر المنخفضة** (احتمالية استقالة <40%):
  - الاستمرار في تقدير جهودهم
  - إشراكهم في برامج التوجيه وتطوير المواهب
  - الاستفادة من خبراتهم في تحسين بيئة العمل

### 3. توصيات مخصصة حسب الأقسام:

- **قسم تكنولوجيا المعلومات**:
  - توفير فرص تعلم التقنيات الجديدة
  - مراجعة الرواتب مقارنة بسوق التكنولوجيا
  - تقديم مشاريع تحدي تقني

- **قسم المبيعات**:
  - تحسين خطط العمولات والحوافز
  - تقديم فرص تطوير مهارات المبيعات
  - الاعتراف بالإنجازات البارزة

- **قسم الموارد البشرية**:
  - تحسين التوازن بين العمل والحياة
  - توفير فرص المشاركة في مبادرات استراتيجية
  - تشجيع الابتكار في ممارسات الموارد البشرية

- **قسم البحث والتطوير**:
  - منح مزيد من الاستقلالية في المشاريع
  - تشجيع الابتكار والإبداع
  - توفير وقت مخصص للمشاريع الشخصية

### 4. توصيات للتنفيذ:

- **إنشاء فريق احتفاظ بالمواهب**:
  - تكوين فريق متعدد التخصصات
  - متابعة تنفيذ الاستراتيجيات
  - قياس فعالية التدخلات

- **وضع آلية للإنذار المبكر**:
  - استخدام نظام التنبؤ بشكل دوري (شهرياً)
  - تحديث البيانات باستمرار
  - تحديد المؤشرات السلوكية للمخاطر

- **قياس النجاح**:
  - تتبع معدل الاحتفاظ بالموظفين
  - قياس التكلفة والعائد من برامج الاحتفاظ
  - تحسين الاستراتيجيات بناءً على النتائج

---

## التكامل مع تقنيات الذكاء الاصطناعي

يتضمن المشروع آلية للتكامل مع نماذج اللغة الكبيرة (LLMs) مثل OpenAI GPT أو Claude من Anthropic لتقديم توصيات أكثر تخصيصاً:

### 1. آلية التكامل:

- **نهج مزدوج**:
  - في حالة توفر مفتاح API: استخدام نماذج الذكاء الاصطناعي للتوصيات
  - في حالة عدم توفره: الاعتماد على النموذج المحلي والتوصيات المعدة مسبقاً

- **تنفيذ التكامل**:
  - التحقق من وجود مفتاح API في متغيرات البيئة
  - إعداد البيانات وإرسالها إلى واجهة برمجة التطبيقات
  - معالجة الاستجابة وعرضها في واجهة المستخدم

- **التخزين المؤقت للتوصيات**:
  - تخزين التوصيات لتجنب إعادة توليدها في كل مرة
  - تحديث التوصيات فقط عند تغيير البيانات أو طلب تحديث صريح

### 2. نوع التوصيات المقدمة:

- **توصيات للمديرين**:
  - استراتيجيات محددة للاحتفاظ بالموظف
  - تحليل أسباب محتملة للمخاطرة العالية
  - خطوات ملموسة للتنفيذ

- **توصيات للموارد البشرية**:
  - تحليل اتجاهات على مستوى القسم
  - اقتراحات لتحسين سياسات الموارد البشرية
  - استراتيجيات طويلة المدى للاحتفاظ بالمواهب

- **توصيات على المستوى التنظيمي**:
  - تحليل المقارنات بين الأقسام
  - اقتراحات للتحسينات الهيكلية
  - استراتيجيات لتحسين ثقافة المؤسسة

### 3. مثال لتنفيذ التكامل مع OpenAI:

```python
def get_ai_recommendations(employee_data, use_openai=True):
    """الحصول على توصيات للحفاظ على الموظف"""
    
    # التحقق من وجود مفتاح API
    openai_api_key = os.environ.get('OPENAI_API_KEY')
    
    if use_openai and openai_api_key:
        try:
            # إعداد البيانات للإرسال إلى OpenAI
            prompt = create_recommendation_prompt(employee_data)
            
            # استدعاء OpenAI API
            from openai import OpenAI
            client = OpenAI(api_key=openai_api_key)
            
            response = client.chat.completions.create(
                model="gpt-4o",  # النموذج الأحدث من OpenAI
                messages=[
                    {"role": "system", "content": "أنت مستشار موارد بشرية خبير متخصص في استبقاء الموظفين."},
                    {"role": "user", "content": prompt}
                ],
                temperature=0.7
            )
            
            recommendations = response.choices[0].message.content
            return recommendations, True
            
        except Exception as e:
            print(f"خطأ في استدعاء OpenAI API: {str(e)}")
    
    # في حالة عدم توفر مفتاح API أو حدوث خطأ، استخدم التوصيات المحلية
    return get_local_recommendations(employee_data), False
```

### 4. استراتيجية الخصوصية والأمان:

- **حماية البيانات الشخصية**:
  - إرسال فقط البيانات الضرورية للتحليل
  - إزالة المعلومات الشخصية المحددة للهوية
  - استخدام معرفات مجهولة بدلاً من الأسماء

- **الالتزام بالمعايير**:
  - الامتثال لمعايير GDPR وقوانين حماية البيانات
  - الحصول على موافقة صريحة قبل استخدام البيانات
  - توفير شفافية كاملة حول استخدام البيانات

- **الخيارات للمستخدمين**:
  - إمكانية تعطيل ميزة الذكاء الاصطناعي
  - خيار استخدام التوصيات المحلية فقط
  - عرض مصدر التوصيات بوضوح (محلي أو ذكاء اصطناعي)

---

## ملفات المشروع الرئيسية وأدوارها

### 1. الملفات الأساسية:

- **app.py**:
  - الملف الرئيسي للتطبيق
  - يحتوي على واجهة المستخدم Streamlit
  - يربط جميع مكونات النظام معاً

- **preprocessing.py**:
  - معالجة البيانات الأولية
  - التعامل مع البيانات المفقودة
  - هندسة السمات

- **model_training.py**:
  - إنشاء وتدريب نماذج التعلم الآلي
  - ضبط بارامترات النماذج
  - تقييم أداء النماذج

- **utils.py**:
  - وظائف مساعدة متنوعة
  - تحميل وحفظ البيانات
  - دوال المعالجة المشتركة

- **visualization.py**:
  - إنشاء الرسومات البيانية
  - تصور نتائج النماذج
  - رسم توزيعات المخاطر

### 2. الملفات الثانوية:

- **evaluate_models.py**:
  - اختبار شامل للنماذج المختلفة
  - مقارنة أداء النماذج
  - توليد تقارير مفصلة

- **feature_importance_analysis.py**:
  - تحليل أهمية المتغيرات
  - رسم ترتيب المتغيرات حسب أهميتها
  - تحليل تأثير المتغيرات على التنبؤات

- **employee_resignation_predictor.ipynb**:
  - دفتر Jupyter يوثق العملية كاملة
  - تحليل تفصيلي للبيانات
  - تجارب النماذج المختلفة

- **employee_resignation_predictor_complete.ipynb**:
  - نسخة موسعة من الدفتر
  - تتضمن تحليلات إضافية واختبارات موثوقية
  - توثيق كامل للعملية بالتفصيل

### 3. ملفات البيانات:

- **employee_data.csv**:
  - مجموعة البيانات الرئيسية
  - 100,000 سجل موظف
  - يتضمن المتغيرات المستقلة والتابعة

- **best_model.pkl**:
  - النموذج المدرب مسبقاً (XGBoost)
  - جاهز للاستخدام في التنبؤات
  - يتضمن خطوات المعالجة المسبقة

### 4. ملفات التوثيق:

- **README.md**:
  - شرح عام للمشروع
  - تعليمات التثبيت والاستخدام
  - وصف للميزات والوظائف

- **شرح_مشروع_التنبؤ_باستقالة_الموظفين.md**:
  - شرح تفصيلي للمشروع
  - منهجية العمل والتحليلات
  - العوامل المؤثرة والتوصيات

### 5. هيكل ملفات التطبيق:

```
employee_resignation_predictor/
│
├── app.py                     # التطبيق الرئيسي
├── preprocessing.py           # معالجة البيانات
├── model_training.py          # تدريب النماذج
├── utils.py                   # وظائف مساعدة
├── visualization.py           # وظائف التصور
│
├── evaluate_models.py         # تقييم النماذج
├── feature_importance_analysis.py  # تحليل أهمية المتغيرات
│
├── employee_data.csv          # بيانات الموظفين
├── best_model.pkl             # النموذج المدرب مسبقاً
│
├── employee_resignation_predictor.ipynb      # دفتر Jupyter
├── employee_resignation_predictor_complete.ipynb  # دفتر Jupyter موسع
│
├── README.md                  # ملف الشرح العام
├── شرح_مشروع_التنبؤ_باستقالة_الموظفين.md  # الشرح التفصيلي
│
└── .streamlit/                # إعدادات Streamlit
    └── config.toml            # ملف التكوين
```

---

## خطوات التنفيذ للمستخدمين

### 1. متطلبات النظام:

- **Python 3.9+**
- **وحدة معالجة مركزية**: لا تقل عن 4 أنوية للأداء الجيد
- **ذاكرة الوصول العشوائي**: 8GB على الأقل (16GB موصى به للبيانات الكبيرة)
- **مساحة التخزين**: 1GB على الأقل
- **اتصال إنترنت**: مطلوب فقط للتوصيات المدعومة بالذكاء الاصطناعي

### 2. تثبيت المتطلبات:

```bash
# إنشاء بيئة افتراضية
python -m venv env

# تفعيل البيئة الافتراضية
# على Windows
env\Scripts\activate
# على Linux/Mac
source env/bin/activate

# تثبيت المتطلبات
pip install -r requirements.txt
```

أو باستخدام conda:

```bash
# إنشاء بيئة conda
conda create -n thard python=3.9

# تفعيل البيئة
conda activate thard

# تثبيت المتطلبات
pip install -r requirements.txt
```

### 3. إعداد متغيرات البيئة (اختياري):

للاستفادة من ميزات الذكاء الاصطناعي، قم بتعيين متغيرات البيئة التالية:

```bash
# على Windows
set OPENAI_API_KEY=your_api_key_here

# على Linux/Mac
export OPENAI_API_KEY=your_api_key_here
```

أو يمكن إنشاء ملف `.env` في المجلد الرئيسي:

```
OPENAI_API_KEY=your_api_key_here
```

### 4. تشغيل التطبيق:

```bash
streamlit run app.py
```

سيتم فتح التطبيق تلقائياً في المتصفح على العنوان `http://localhost:5000`

### 5. استخدام التطبيق:

#### الصفحة الرئيسية:
- **نظرة عامة** على النظام ومؤشرات الأداء الرئيسية
- **إحصاءات موجزة** عن بيانات الموظفين
- **رسوم بيانية** للاتجاهات العامة

#### تحميل البيانات:
- **استخدام البيانات المضمنة** أو تحميل ملف CSV جديد
- **التحقق من تنسيق البيانات** ومطابقتها للهيكل المطلوب
- **استعراض البيانات المحملة** وإحصاءاتها الأساسية

#### تحليل البيانات:
- **استكشاف المتغيرات** والعلاقات بينها
- **رسوم بيانية تفاعلية** للتوزيعات والارتباطات
- **تحليل حسب القسم** أو أي متغير تصنيفي آخر

#### التنبؤ بالمخاطر:
- **تنبؤات على مستوى الفرد** لكل موظف
- **تحليل على مستوى القسم** للمخاطر المجمعة
- **تصفية وفرز** النتائج حسب مستوى المخاطر

#### التوصيات:
- **توصيات عامة** للمؤسسة
- **توصيات مخصصة** لكل موظف أو قسم
- **استخدام الذكاء الاصطناعي** للتوصيات إذا كان متاحاً

#### لوحة التحكم الإدارية:
- **تتبع فعالية التدخلات** والاستراتيجيات
- **مقارنة الأقسام** والمجموعات المختلفة
- **تصدير التقارير** بتنسيقات متعددة

---

## التحديات وحلولها

خلال تطوير المشروع، واجهنا عدداً من التحديات التقنية والعملية:

### 1. تحديات البيانات الكبيرة:

- **التحدي**: التعامل مع 100,000 سجل بكفاءة في تطبيق Streamlit
- **الحل**: 
  - تنفيذ آلية تحميل تدريجي للبيانات
  - استخدام التخزين المؤقت لتحسين الأداء
  - ترشيد عرض البيانات باستخدام التجميع والتصفية

### 2. عدم التوازن في البيانات:

- **التحدي**: فقط 10% من الموظفين استقالوا، مما يؤثر على دقة النماذج
- **الحل**: 
  - استخدام أخذ عينات أقل للفئة الأكثر تمثيلاً
  - استخدام مقاييس مناسبة (ROC AUC، F1)
  - تطبيق تقنيات التحقق المتقاطع الطبقي

### 3. تعقيد النموذج مقابل الأداء:

- **التحدي**: الموازنة بين تعقيد النموذج ودقته وسرعة التنفيذ
- **الحل**: 
  - مقارنة منهجية لنماذج مختلفة
  - تحسين البارامترات للأداء الأمثل
  - تنفيذ أساليب التخزين المؤقت للتنبؤات

### 4. التكامل مع الذكاء الاصطناعي:

- **التحدي**: تنفيذ التكامل مع واجهة برمجة تطبيقات OpenAI بشكل آمن وفعال
- **الحل**: 
  - آلية تنفيذ مزدوجة (مع/بدون ذكاء اصطناعي)
  - تخزين مؤقت للتوصيات لتقليل استهلاك واجهة برمجة التطبيقات
  - التعامل الآمن مع مفاتيح API ومعلومات الاعتماد

### 5. أداء واجهة المستخدم:

- **التحدي**: بطء التحميل والتفاعل مع الرسوم البيانية الكثيرة
- **الحل**: 
  - تقسيم العرض إلى علامات تبويب وأقسام
  - تحميل الرسوم البيانية عند الطلب فقط
  - تحسين كفاءة استعلامات البيانات

### 6. تخصيص توصيات الاحتفاظ:

- **التحدي**: توليد توصيات مفيدة وقابلة للتنفيذ لكل موظف
- **الحل**: 
  - بناء إطار توصيات استناداً إلى تحليل العوامل
  - التكامل مع نماذج الذكاء الاصطناعي عند توفرها
  - نظام تصنيف لمستويات التدخل المختلفة

### 7. استخدام المستخدم في بيئة العمل:

- **التحدي**: ضمان سهولة استخدام التطبيق من قبل مستخدمين غير تقنيين
- **الحل**: 
  - واجهة بسيطة وبديهية بالعربية
  - شروحات ضمنية وتلميحات للمساعدة
  - آليات تدقيق وتحقق من الإدخال

---

## التطوير المستقبلي

هناك عدة اتجاهات محتملة لتطوير المشروع مستقبلاً:

### 1. تحسينات النموذج:

- **نماذج التعلم العميق**:
  - استكشاف نماذج الشبكات العصبية
  - تنفيذ LSTM للتنبؤ على أساس البيانات الزمنية
  - استخدام نماذج التشفير التلقائي لاكتشاف الأنماط غير المرئية

- **التعلم المستمر**:
  - تنفيذ آلية التحديث التلقائي للنموذج
  - تضمين ردود فعل مستخدم لتحسين التنبؤات
  - إعادة تدريب دورية مع البيانات الجديدة

### 2. توسيع نطاق البيانات:

- **مصادر بيانات جديدة**:
  - دمج بيانات أنظمة الموارد البشرية المختلفة
  - إضافة مؤشرات سلوكية (مثل أنماط البريد الإلكتروني)
  - تضمين بيانات استطلاعات المشاركة الدورية

- **تحليل السياق الأوسع**:
  - إضافة بيانات سوق العمل الخارجية
  - مراعاة الاتجاهات الاقتصادية والقطاعية
  - تضمين مؤشرات الصناعة المرجعية

### 3. تحسينات واجهة المستخدم:

- **تجربة مستخدم متقدمة**:
  - مخصصات متقدمة للوحات المعلومات
  - تنبيهات وإشعارات للمخاطر العالية
  - تطبيق موبايل للمديرين

- **تكامل التقارير**:
  - تصدير تلقائي للتقارير الدورية
  - جدولة التنبيهات والتقارير
  - تكامل مع أنظمة البريد الإلكتروني والرسائل

### 4. توسيع نطاق التكامل:

- **تكامل مع الأنظمة الأخرى**:
  - ربط مع أنظمة إدارة الموارد البشرية الرئيسية
  - تكامل مع أنظمة إدارة المواهب
  - ربط مع أنظمة الرواتب والمكافآت

- **واجهة برمجة تطبيقات (API)**:
  - تطوير API لتسهيل التكامل مع أنظمة أخرى
  - خدمات ويب لعمليات التنبؤ
  - واجهة برمجة تطبيقات المسؤول للتكوين عن بعد

### 5. تعزيز التوصيات:

- **نظام توصيات ذكي**:
  - استخدام المزيد من نماذج الذكاء الاصطناعي المتخصصة
  - تطوير خوارزميات توصية استباقية
  - تتبع فعالية التوصيات لتحسين دقتها

- **أتمتة الإجراءات**:
  - اقتراح وجدولة لقاءات الحفاظ على الموظفين
  - بدء تدخلات تلقائية للمخاطر العالية
  - تكامل مع أنظمة سير العمل

### 6. التدويل والتخصيص:

- **دعم لغات إضافية**:
  - توسيع الدعم للغات أخرى
  - مراعاة الاختلافات الثقافية في التحليل

- **تخصيص حسب القطاع**:
  - نماذج مخصصة للقطاعات المختلفة
  - معايير مرجعية خاصة بالصناعة
  - تحليلات مقارنة مع المنافسين

---

هذا الشرح التفصيلي يقدم نظرة شاملة على مشروع التنبؤ باستقالة الموظفين، بدءاً من المفاهيم الأساسية وصولاً إلى التفاصيل التقنية والتوصيات المستقبلية. يمكن استخدامه كمرجع للفهم العميق للمشروع وآلية عمله.
